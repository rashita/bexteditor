# MCPサーバーを利用した外部ファイル連携に関するメモ

## 経緯

AIエージェント（Gemini）との対話において、作業ディレクトリ外のファイルを安全かつ効率的に参照・操作する方法について検討した。

## Q&Aまとめ

### Q1. AIエージェントは作業ディレクトリ外のファイルを参照・操作できるか？

**A1.** 原則として、指定された作業ディレクトリ（この場合は `bextEditor`）内でのみ活動する。技術的には絶対パスで外部ファイルにアクセス可能だが、安全上の理由から、ユーザーの明確な許可なく実行することはない。

### Q2. MCPサーバーのような仕組みで、一時的に外部フォルダを共有することは可能か？

**A2.** 可能である。ユーザーがローカル環境で特定のフォルダを公開するサーバー（HTTPサーバーや、記事で紹介されたMCPサーバーなど）を起動し、そのURLをエージェントに伝えれば、エージェントは `web_fetch` ツールなどを通じてそのサーバーにアクセスし、公開されている情報を参照できる。

### Q3. その仕組みを利用した場合、ファイルの読み取りだけでなく、書き込みや削除も可能か？

**A3.** 可能である。どのような操作を許可するかは、全てユーザーが構築するサーバー側のAPI実装に依存する。例えば、ファイル書き込み用のAPIエンドポイント（例: `POST /files`）をサーバーに実装し、その仕様をエージェントに伝えれば、エージェントはそのAPIを呼び出してファイルの書き込みを行うことができる。これにより、ユーザーはエージェントに許可する操作範囲を安全にコントロールできる。

### Q4. なぜこのような仕組みを検討したのか？

**A4.** 手持ちのファイルをすべて参照対象にすると、AIエージェントが消費するトークン量が増大し、コスト、応答速度、精度の面で非効率になる可能性があるため。必要なデータソースだけを動的に「接続」し、不要になったら「切断」するアプローチにより、効率的な連携を目指すことが目的である。
